<!DOCTYPE html>
<html lang="fa">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø§Ù¾ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>
<style>
  @import url('https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css');
  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Vazir', Tahoma, sans-serif;
    background: #121212;
    color: #eee;
    margin: 0; padding: 0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  header {
    background: #1f1f1f;
    width: 100%;
    padding: 1rem 1.5rem;
    text-align: center;
    font-size: 1.7rem;
    font-weight: 700;
    letter-spacing: 1.2px;
    color: #f0f0f0;
    box-shadow: 0 2px 6px rgba(0,0,0,0.7);
  }
  main {
    flex: 1;
    max-width: 1100px;
    width: 95%;
    margin: 1rem auto 2rem;
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
  }
  form {
    background: #222;
    border-radius: 10px;
    padding: 1rem 1.3rem;
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    align-items: center;
    box-shadow: 0 0 8px #00a8ff55;
  }
  form input[type=text], form input[type=number], form select {
    background: #333;
    border: none;
    outline: none;
    padding: 0.7rem 1rem;
    border-radius: 6px;
    color: #eee;
    font-size: 1rem;
    min-width: 140px;
    transition: background-color 0.3s ease;
  }
  form input[type=text]:focus,
  form input[type=number]:focus,
  form select:focus {
    background: #444;
  }
  form button {
    background: #00a8ff;
    border: none;
    color: white;
    font-weight: 600;
    padding: 0.7rem 1.5rem;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    min-width: 100px;
  }
  form button:hover {
    background: #0090dd;
  }

  /* ÙˆØ¶Ø¹ÛŒØª ÙÛŒÙ„ØªØ± */
  .filters {
    background: #222;
    border-radius: 10px;
    padding: 1rem 1.3rem;
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    align-items: center;
    box-shadow: 0 0 6px #00a8ff55;
  }
  .filters select, .filters input[type=search] {
    background: #333;
    border: none;
    outline: none;
    padding: 0.6rem 1rem;
    border-radius: 6px;
    color: #eee;
    font-size: 1rem;
    min-width: 150px;
  }
  .filters input[type=search] {
    flex: 1;
    min-width: 200px;
  }
  .filters select:focus,
  .filters input[type=search]:focus {
    background: #444;
  }

  /* Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ */
  .columns {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    justify-content: space-between;
  }
  .column {
    background: #222;
    flex: 1;
    min-width: 280px;
    max-width: 350px;
    border-radius: 10px;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    box-shadow: 0 0 10px #00a8ff33;
    max-height: 70vh;
    overflow-y: auto;
  }
  .column h3 {
    margin: 0 0 0.8rem;
    font-weight: 700;
    color: #00a8ff;
    text-align: center;
    border-bottom: 2px solid #00a8ff88;
    padding-bottom: 0.3rem;
  }

  /* Ú©Ø§Ø±Øª Ù¾Ø±ÙˆÚ˜Ù‡ */
  .task {
    background: #333;
    border-radius: 8px;
    padding: 0.9rem 1rem;
    margin-bottom: 0.8rem;
    box-shadow: 0 1px 4px #0008;
    color: #eee;
    display: flex;
    flex-direction: column;
    cursor: grab;
    user-select: none;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    position: relative;
  }
  .task.dragging {
    opacity: 0.7;
    cursor: grabbing;
    box-shadow: 0 0 12px #00a8ffcc;
  }
  .task:hover {
    background: #3a3a3a;
    box-shadow: 0 0 15px #00a8ffcc;
  }

  .task-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .task-title {
    font-weight: 600;
    font-size: 1.1rem;
    flex: 1;
    padding-right: 0.6rem;
    word-break: break-word;
  }
  .task-title[contenteditable="true"] {
    outline: 2px solid #00a8ff;
    border-radius: 4px;
    background: #444;
  }
  .task-price {
    font-weight: 700;
    min-width: 60px;
    text-align: left;
    direction: ltr;
    color: #4cd137;
    user-select: none;
  }
  .task-price[contenteditable="true"] {
    outline: 2px solid #4cd137;
    background: #2c2c2c;
    border-radius: 4px;
  }

  .task-buttons {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.6rem;
    justify-content: flex-end;
  }
  .task-buttons button {
    border: none;
    background: transparent;
    color: #bbb;
    font-size: 1.2rem;
    cursor: pointer;
    transition: color 0.25s ease;
    padding: 0.15rem 0.4rem;
    border-radius: 4px;
  }
  .task-buttons button:hover {
    color: #00a8ff;
  }

  /* ÙˆØ¶Ø¹ÛŒØª Ø§ÙˆÙ„ÙˆÛŒØª */
  .priority-low {
    border-left: 5px solid #718093;
  }
  .priority-medium {
    border-left: 5px solid #e1b12c;
  }
  .priority-high {
    border-left: 5px solid #e84118;
  }

  /* Ø¯Ú©Ù…Ù‡ ÙˆÛŒØ±Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª */
  .status-select {
    margin-top: 0.6rem;
    background: #222;
    border-radius: 6px;
    padding: 0.3rem 0.5rem;
    color: #eee;
    font-size: 0.9rem;
    width: 100%;
    border: 1px solid #555;
    cursor: pointer;
    user-select: none;
  }
  .status-select:hover {
    border-color: #00a8ff;
  }

  /* Ø§Ø³Ú©Ø±ÙˆÙˆÙ„ Ø¯Ø§Ø®Ù„ Ø³ØªÙˆÙ† */
  .column::-webkit-scrollbar {
    width: 7px;
  }
  .column::-webkit-scrollbar-track {
    background: #1b1b1b;
    border-radius: 10px;
  }
  .column::-webkit-scrollbar-thumb {
    background: #00a8ff88;
    border-radius: 10px;
  }

  /* Ø¨Ø®Ø´ Ø¢Ù…Ø§Ø± */
  .stats {
    background: #222;
    border-radius: 10px;
    padding: 1rem 1.3rem;
    margin-top: 0.8rem;
    color: #eee;
    box-shadow: 0 0 8px #00a8ff55;
    display: flex;
    gap: 1.3rem;
    justify-content: center;
    flex-wrap: wrap;
  }
  .stats div {
    font-weight: 600;
    min-width: 120px;
    text-align: center;
    font-size: 1rem;
  }

  /* Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ */
  @media (max-width: 800px) {
    .columns {
      flex-direction: column;
      max-height: 70vh;
    }
    .column {
      max-width: 100%;
      max-height: 35vh;
    }
  }
</style>
</head>
<body>

<header>Ø§Ù¾ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</header>

<main>
  <form id="addTaskForm" autocomplete="off" spellcheck="false" aria-label="ÙØ±Ù… Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù¾Ø±ÙˆÚ˜Ù‡ Ø¬Ø¯ÛŒØ¯">
    <input type="text" id="taskTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ù¾Ø±ÙˆÚ˜Ù‡..." required aria-required="true" />
    <select id="taskPriority" aria-label="Ø§Ù†ØªØ®Ø§Ø¨ Ø§ÙˆÙ„ÙˆÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡" required>
      <option value="" disabled selected>Ø§ÙˆÙ„ÙˆÛŒØª...</option>
      <option value="low">Ú©Ù…</option>
      <option value="medium">Ù…ØªÙˆØ³Ø·</option>
      <option value="high">Ø²ÛŒØ§Ø¯</option>
    </select>
    <input type="number" id="taskPrice" placeholder="Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†)" min="0" step="1000" aria-label="Ù‚ÛŒÙ…Øª Ù¾Ø±ÙˆÚ˜Ù‡" />
    <select id="taskStatus" aria-label="ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡" required>
      <option value="" disabled selected>ÙˆØ¶Ø¹ÛŒØª...</option>
      <option value="todo"> Ù„ÛŒØ³Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§</option>
      <option value="inprogress">Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</option>
      <option value="done">ØªØ­ÙˆÛŒÙ„ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡</option>
    </select>
    <button type="submit" aria-label="Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù¾Ø±ÙˆÚ˜Ù‡">Ø§ÙØ²ÙˆØ¯Ù†</button>
  </form>

  <section class="filters" aria-label="ÙÛŒÙ„ØªØ±Ù‡Ø§ Ùˆ Ø¬Ø³ØªØ¬Ùˆ">
    <select id="filterStatus" aria-label="ÙÛŒÙ„ØªØ± ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡">
      <option value="all">Ù‡Ù…Ù‡ ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§</option>
      <option value="todo"> Ù„ÛŒØ³Øª  Ù¾Ø±ÙˆØ²Ù‡ Ù‡Ø§</option>
      <option value="inprogress">Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</option>
      <option value="done">ØªØ­ÙˆÛŒÙ„ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡</option>
    </select>

    <select id="filterPriority" aria-label="ÙÛŒÙ„ØªØ± Ø§ÙˆÙ„ÙˆÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡">
      <option value="all">Ù‡Ù…Ù‡ Ø§ÙˆÙ„ÙˆÛŒØªâ€ŒÙ‡Ø§</option>
      <option value="low">Ú©Ù…</option>
      <option value="medium">Ù…ØªÙˆØ³Ø·</option>
      <option value="high">Ø²ÛŒØ§Ø¯</option>
    </select>

    <input type="search" id="searchBox" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ø¹Ù†ÙˆØ§Ù†..." aria-label="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù¾Ø±ÙˆÚ˜Ù‡" />
  </section>

  <section class="columns" aria-label="Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§">
    <div id="todoColumn" class="column" aria-live="polite" aria-label="Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ  Ù„ÛŒØ³Øª Ù¾Ø±ÙˆØ²Ù‡ Ù‡Ø§">
      <h3> Ù„ÛŒØ³Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§</h3>
    </div>
    <div id="inprogressColumn" class="column" aria-live="polite" aria-label="Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…">
      <h3>Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</h3>
    </div>
    <div id="doneColumn" class="column" aria-live="polite" aria-label="Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ­ÙˆÛŒÙ„ Ø¯Ø§Ø¯ Ø´Ø¯Ù‡">
      <h3>ØªØ­ÙˆÛŒÙ„ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡</h3>
    </div>
  </section>

  <section class="stats" aria-label="Ø¢Ù…Ø§Ø± Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§">
    <div>Ú©Ù„ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§: <span id="totalCount">0</span></div>
    <div>Ø¯Ø± Ù„ÛŒØ³Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§: <span id="countTodo">0</span></div>
    <div>Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…: <span id="countInProgress">0</span></div>
    <div>ØªØ­ÙˆÛŒÙ„ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡: <span id="countDone">0</span></div>
    <div>Ø¬Ù…Ø¹ Ù‚ÛŒÙ…Øª Ú©Ù„: <span id="totalPrice">0</span> ØªÙˆÙ…Ø§Ù†</div>
  </section>
</main>

<script>
  'use strict';

  const addTaskForm = document.getElementById('addTaskForm');
  const taskTitleInput = document.getElementById('taskTitle');
  const taskPrioritySelect = document.getElementById('taskPriority');
  const taskPriceInput = document.getElementById('taskPrice');
  const taskStatusSelect = document.getElementById('taskStatus');

  const filterStatus = document.getElementById('filterStatus');
  const filterPriority = document.getElementById('filterPriority');
  const searchBox = document.getElementById('searchBox');

  const todoColumn = document.getElementById('todoColumn');
  const inprogressColumn = document.getElementById('inprogressColumn');
  const doneColumn = document.getElementById('doneColumn');

  const totalCount = document.getElementById('totalCount');
  const countTodo = document.getElementById('countTodo');
  const countInProgress = document.getElementById('countInProgress');
  const countDone = document.getElementById('countDone');
  const totalPrice = document.getElementById('totalPrice');

  let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

  function saveTasks() {
    localStorage.setItem('tasks', JSON.stringify(tasks));
  }

  // Ø³Ø§Ø®Øª Ú©Ø§Ø±Øª ØªØ³Ú©
  function createTaskElement(task) {
    const taskDiv = document.createElement('div');
    taskDiv.className = `task priority-${task.priority}`;
    taskDiv.draggable = true;
    taskDiv.dataset.id = task.id;

    // Ù‡Ø¯Ø± Ø¨Ø§ Ø¹Ù†ÙˆØ§Ù† Ùˆ Ù‚ÛŒÙ…Øª
    const header = document.createElement('div');
    header.className = 'task-header';

    const title = document.createElement('div');
    title.className = 'task-title';
    title.textContent = task.title;
    title.title = 'Ø¯Ø§Ø¨Ù„ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´';
    title.contentEditable = false;
    title.spellcheck = false;

    // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† ÙˆÛŒØ±Ø§ÛŒØ´ Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§ Ø¯Ø§Ø¨Ù„ Ú©Ù„ÛŒÚ©
    title.addEventListener('dblclick', () => {
      title.contentEditable = true;
      title.focus();
    });
    title.addEventListener('blur', () => {
      title.contentEditable = false;
      if(title.textContent.trim() === '') {
        alert('Ø¹Ù†ÙˆØ§Ù† Ù¾Ø±ÙˆÚ˜Ù‡ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø®Ø§Ù„ÛŒ Ø¨Ø§Ø´Ø¯!');
        title.textContent = task.title;
        return;
      }
      task.title = title.textContent.trim();
      saveTasks();
      renderTasks();
    });
    title.addEventListener('keydown', (e) => {
      if(e.key === 'Enter') {
        e.preventDefault();
        title.blur();
      }
    });

    const price = document.createElement('div');
    price.className = 'task-price';
    price.textContent = task.price.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
    price.title = 'Ø¯Ø§Ø¨Ù„ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª';
    price.contentEditable = false;
    price.spellcheck = false;

    price.addEventListener('dblclick', () => {
      price.contentEditable = true;
      price.focus();
    });
    price.addEventListener('blur', () => {
      price.contentEditable = false;
      let newPrice = parseInt(price.textContent.replace(/[^0-9]/g, ''));
      if(isNaN(newPrice) || newPrice < 0) newPrice = 0;
      price.textContent = newPrice.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
      task.price = newPrice;
      saveTasks();
      renderTasks();
    });
    price.addEventListener('keydown', (e) => {
      if(e.key === 'Enter') {
        e.preventDefault();
        price.blur();
      }
    });

    header.appendChild(title);
    header.appendChild(price);
    taskDiv.appendChild(header);

    // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§: Ø­Ø°Ù Ùˆ ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª
    const btns = document.createElement('div');
    btns.className = 'task-buttons';

    // Ø­Ø°Ù
    const deleteBtn = document.createElement('button');
    deleteBtn.title = 'Ø­Ø°Ù Ù¾Ø±ÙˆÚ˜Ù‡';
    deleteBtn.innerHTML = 'ğŸ—‘ï¸';
    deleteBtn.addEventListener('click', () => {
      if(confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
        tasks = tasks.filter(t => t.id !== task.id);
        saveTasks();
        renderTasks();
      }
    });
    btns.appendChild(deleteBtn);

    // ÙˆØ¶Ø¹ÛŒØª (select)
    const statusSelect = document.createElement('select');
    statusSelect.className = 'status-select';
    statusSelect.title = 'ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡';
    ['todo', 'inprogress', 'done'].forEach(status => {
      const opt = document.createElement('option');
      opt.value = status;
      opt.textContent = 
        status === 'todo' ? ' Ù„ÛŒØ³Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§' :
        status === 'inprogress' ? 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…' : 'ØªØ­ÙˆÛŒÙ„ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡';
      if(task.status === status) opt.selected = true;
      statusSelect.appendChild(opt);
    });
    statusSelect.addEventListener('change', () => {
      task.status = statusSelect.value;
      saveTasks();
      renderTasks();
    });
    btns.appendChild(statusSelect);

    // Ø§ÙˆÙ„ÙˆÛŒØª (select)
    const prioritySelect = document.createElement('select');
    prioritySelect.className = 'status-select';
    prioritySelect.title = 'ØªØºÛŒÛŒØ± Ø§ÙˆÙ„ÙˆÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡';
    ['low', 'medium', 'high'].forEach(pri => {
      const opt = document.createElement('option');
      opt.value = pri;
      opt.textContent = 
        pri === 'low' ? 'Ú©Ù…' : pri === 'medium' ? 'Ù…ØªÙˆØ³Ø·' : 'Ø²ÛŒØ§Ø¯';
      if(task.priority === pri) opt.selected = true;
      prioritySelect.appendChild(opt);
    });
    prioritySelect.addEventListener('change', () => {
      task.priority = prioritySelect.value;
      saveTasks();
      renderTasks();
    });
    btns.appendChild(prioritySelect);

    taskDiv.appendChild(btns);

    // Drag events
    taskDiv.addEventListener('dragstart', e => {
      taskDiv.classList.add('dragging');
      e.dataTransfer.setData('text/plain', task.id);
      e.dataTransfer.effectAllowed = 'move';
    });
    taskDiv.addEventListener('dragend', () => {
      taskDiv.classList.remove('dragging');
    });

    return taskDiv;
  }

  // Ø±Ù†Ø¯Ø± Ù‡Ù…Ù‡ ØªØ³Ú©â€ŒÙ‡Ø§ Ø¨Ø§ ÙÛŒÙ„ØªØ±
  function renderTasks() {
    todoColumn.innerHTML = '<h3> Ù„ÛŒØ³Øª Ù¾Ø±ÙˆÚ˜Ù‡ Ù‡Ø§</h3>';
    inprogressColumn.innerHTML = '<h3>Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</h3>';
    doneColumn.innerHTML = '<h3>ØªØ­ÙˆÛŒÙ„ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡</h3>';

    const statusFilter = filterStatus.value;
    const priorityFilter = filterPriority.value;
    const searchTerm = searchBox.value.trim().toLowerCase();

    let filteredTasks = tasks.filter(task => {
      let statusOk = statusFilter === 'all' || task.status === statusFilter;
      let priorityOk = priorityFilter === 'all' || task.priority === priorityFilter;
      let searchOk = task.title.toLowerCase().includes(searchTerm);
      return statusOk && priorityOk && searchOk;
    });

    filteredTasks.forEach(task => {
      const taskElem = createTaskElement(task);
      if(task.status === 'todo') todoColumn.appendChild(taskElem);
      else if(task.status === 'inprogress') inprogressColumn.appendChild(taskElem);
      else if(task.status === 'done') doneColumn.appendChild(taskElem);
    });

    updateStats(filteredTasks);
  }

  // Ø¢Ù…Ø§Ø±
  function updateStats(filtered) {
    totalCount.textContent = filtered.length;

    const countByStatus = {todo:0, inprogress:0, done:0};
    let totalPriceSum = 0;

    filtered.forEach(task => {
      countByStatus[task.status]++;
      totalPriceSum += task.price;
    });

    countTodo.textContent = countByStatus.todo;
    countInProgress.textContent = countByStatus.inprogress;
    countDone.textContent = countByStatus.done;
    totalPrice.textContent = totalPriceSum.toLocaleString();
  }

  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù¾Ø±ÙˆÚ˜Ù‡ Ø¬Ø¯ÛŒØ¯
  addTaskForm.addEventListener('submit', e => {
    e.preventDefault();
    const title = taskTitleInput.value.trim();
    const priority = taskPrioritySelect.value;
    const price = parseInt(taskPriceInput.value) || 0;
    const status = taskStatusSelect.value;

    if(!title) {
      alert('Ø¹Ù†ÙˆØ§Ù† Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
      return;
    }
    if(!priority) {
      alert('Ø§ÙˆÙ„ÙˆÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
      return;
    }
    if(!status) {
      alert('ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
      return;
    }

    const newTask = {
      id: Date.now().toString(),
      title,
      priority,
      price,
      status
    };
    tasks.push(newTask);
    saveTasks();
    renderTasks();

    addTaskForm.reset();
  });

  // ÙÛŒÙ„ØªØ±Ù‡Ø§ Ùˆ Ø¬Ø³ØªØ¬Ùˆ
  [filterStatus, filterPriority, searchBox].forEach(input => {
    input.addEventListener('input', renderTasks);
  });

  // Drag & Drop Ø³ØªÙˆÙ†â€ŒÙ‡Ø§
  [todoColumn, inprogressColumn, doneColumn].forEach(column => {
    column.addEventListener('dragover', e => {
      e.preventDefault();
      const draggingTask = document.querySelector('.dragging');
      const afterElement = getDragAfterElement(column, e.clientY);
      if(afterElement == null) {
        column.appendChild(draggingTask);
      } else {
        column.insertBefore(draggingTask, afterElement);
      }
    });

    column.addEventListener('drop', e => {
      e.preventDefault();
      const draggingTask = document.querySelector('.dragging');
      if(!draggingTask) return;

      // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª
      const taskId = draggingTask.dataset.id;
      const task = tasks.find(t => t.id === taskId);
      if(!task) return;

      let newStatus = '';
      if(column.id === 'todoColumn') newStatus = 'todo';
      else if(column.id === 'inprogressColumn') newStatus = 'inprogress';
      else if(column.id === 'doneColumn') newStatus = 'done';

      task.status = newStatus;
      saveTasks();
      renderTasks();
    });
  });

  // Ú¯Ø±ÙØªÙ† Ø¹Ù†ØµØ± Ø²ÛŒØ± Ù†Ø´Ø§Ù†Ú¯Ø± Ø¯Ø± Drag
  function getDragAfterElement(container, y) {
    const draggableElements = [...container.querySelectorAll('.task:not(.dragging)')];

    return draggableElements.reduce((closest, child) => {
      const box = child.getBoundingClientRect();
      const offset = y - box.top - box.height/2;
      if(offset < 0 && offset > closest.offset) {
        return {offset: offset, element: child};
      } else {
        return closest;
      }
    }, {offset: Number.NEGATIVE_INFINITY}).element;
  }

  // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
  renderTasks();

</script>

</body>
</html>


<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø´ØªØ±ÛŒâ€ŒÙ‡Ø§ - Ø¨Ø§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ùˆ ØµØ¯Ø§</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Vazir&display=swap');
    body {
      background-color: #121212;
      font-family: 'Vazir', sans-serif;
      color: #f0f0f0;
      margin: 0;
      padding: 20px;
      user-select: none;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      font-weight: 700;
      font-size: 2.2rem;
      color: #5a5af3;
      text-shadow: 0 0 8px #5a5af3aa;
    }
    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 800px;
      margin: 0 auto 25px auto;
      gap: 15px;
    }
    .controls input,
    .controls select {
      flex: 1;
      max-width: 250px;
      padding: 12px 15px;
      border-radius: 12px;
      border: none;
      background: #1f1f1f;
      color: #ddd;
      font-size: 15px;
      transition: background-color 0.3s ease;
    }
    .controls input::placeholder {
      color: #888;
    }
    .controls input:focus,
    .controls select:focus {
      outline: none;
      background: #3535ff22;
      box-shadow: 0 0 8px #5a5af3aa;
      color: #fff;
    }
    #soundToggle {
      flex: none;
      background: #5a5af3;
      border-radius: 12px;
      padding: 10px 16px;
      color: white;
      font-weight: 700;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 0 15px #5a5af3bb;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    #soundToggle:hover {
      background: #7a7aff;
      transform: scale(1.05);
    }
    #customerForm {
      max-width: 800px;
      margin: 0 auto 30px auto;
      background: linear-gradient(145deg, #1e1e1e, #222222);
      padding: 20px 25px;
      border-radius: 20px;
      box-shadow:
        6px 6px 12px #151515,
        -6px -6px 12px #2a2a2a;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }
    #customerForm input,
    #customerForm select,
    #customerForm textarea {
      background: #1f1f1f;
      color: #eee;
      border-radius: 15px;
      border: none;
      padding: 14px 18px;
      font-size: 16px;
      flex: 1 1 220px;
      min-width: 220px;
      transition: box-shadow 0.3s ease;
      resize: none;
    }
    #customerForm input::placeholder,
    #customerForm textarea::placeholder {
      color: #888;
    }
    #customerForm input:focus,
    #customerForm select:focus,
    #customerForm textarea:focus {
      outline: none;
      box-shadow: 0 0 10px #5a5af3cc;
      background: #2a2aff11;
      color: #fff;
    }
    #customerForm textarea {
      height: 60px;
    }
    #customerForm button {
      background: #5a5af3;
      color: white;
      font-weight: 700;
      padding: 14px 30px;
      border-radius: 20px;
      border: none;
      cursor: pointer;
      font-size: 17px;
      flex: 1 1 120px;
      max-width: 150px;
      transition: background-color 0.3s ease, transform 0.2s ease;
      box-shadow: 0 0 20px #5a5af3bb;
    }
    #customerForm button:hover {
      background: #7a7aff;
      transform: scale(1.05);
      box-shadow: 0 0 30px #7a7affdd;
    }
    #customerList {
      max-width: 800px;
      margin: 0 auto;
      padding: 0;
      list-style: none;
    }
    .card {
      background: linear-gradient(145deg, #1a1a1a, #1c1c1c);
      margin-bottom: 20px;
      padding: 20px 25px;
      border-radius: 18px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      box-shadow:
        5px 5px 12px #151515,
        -5px -5px 12px #2a2a2a;
      cursor: default;
      animation: fadeInUp 0.45s ease forwards;
      position: relative;
      overflow: hidden;
      transition: box-shadow 0.3s ease, transform 0.3s ease;
    }
    .card:hover {
      box-shadow:
        10px 10px 25px #151515bb,
        -10px -10px 25px #2a2a2abb;
      transform: scale(1.03);
      z-index: 10;
    }
    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(25px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .info {
      line-height: 1.6;
      max-width: 70%;
      user-select: text;
    }
    .info strong {
      font-size: 1.4rem;
      color: #8a8aff;
      text-shadow: 0 0 10px #5a5af3cc;
      display: block;
      margin-bottom: 6px;
    }
    .info span {
      display: block;
      font-size: 0.9rem;
      color: #bbb;
      margin: 3px 0;
    }
    .tags {
      font-size: 0.8rem;
      margin-top: 8px;
      font-weight: 700;
      color: #5a5af3cc;
    }
    .actions {
      display: flex;
      flex-direction: column;
      gap: 12px;
      flex-shrink: 0;
      margin-left: 20px;
    }
    .actions button {
      background: #444;
      padding: 10px 14px;
      font-size: 16px;
      border-radius: 12px;
      color: #ddd;
      cursor: pointer;
      border: none;
      transition: background 0.3s ease, transform 0.15s ease;
      box-shadow: 0 0 5px transparent;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .actions button.edit {
      background-color: #3498db;
      box-shadow: 0 0 12px #3498dbaa;
    }
    .actions button.delete {
      background-color: #e74c3c;
      box-shadow: 0 0 12px #e74c3caa;
    }
    .actions button:hover {
      transform: scale(1.12);
      box-shadow: 0 0 18px #5a5af3ff;
      color: white;
    }
    /* Slide out animation for deleting card */
    @keyframes slideOutLeft {
      0% {
        opacity: 1;
        transform: translateX(0);
        height: 100%;
        margin-bottom: 20px;
      }
      100% {
        opacity: 0;
        transform: translateX(-150%);
        height: 0;
        margin-bottom: 0;
        padding-top: 0;
        padding-bottom: 0;
      }
    }
  </style>
</head>
<body>
  <h2>Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø´ØªØ±ÛŒâ€ŒÙ‡Ø§ </h2>
  <div class="controls">
    <input type="text" id="searchInput" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ø´ØªØ±ÛŒ..." autocomplete="off" />
    <select id="sortSelect" aria-label="Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ù…Ø´ØªØ±ÛŒâ€ŒÙ‡Ø§">
      <option value="date">Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ§Ø±ÛŒØ®</option>
      <option value="name">Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ø§Ù…</option>
      <option value="tag">Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªÚ¯</option>
    </select>
    <button id="soundToggle" aria-pressed="true" title="Ø±ÙˆØ´Ù†/Ø®Ø§Ù…ÙˆØ´ Ú©Ø±Ø¯Ù† ØµØ¯Ø§">ğŸ”Š ØµØ¯Ø§ Ø±ÙˆØ´Ù†</button>
  </div>
  <form id="customerForm" autocomplete="off" aria-label="ÙØ±Ù… Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ">
    <input type="text" id="name" placeholder="Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ" required aria-required="true" />
    <input type="text" id="insta" placeholder="Ø¢ÛŒØ¯ÛŒ Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù…" />
    <input type="text" id="telegram" placeholder="Ø¢ÛŒØ¯ÛŒ ØªÙ„Ú¯Ø±Ø§Ù…" />
    <textarea id="note" placeholder="ÛŒØ§Ø¯Ø¯Ø§Ø´Øª"></textarea>
    <select id="tag" aria-label="Ø§Ù†ØªØ®Ø§Ø¨ ØªÚ¯ Ù…Ø´ØªØ±ÛŒ">
      <option value="Ø¹Ø§Ø¯ÛŒ">Ø¹Ø§Ø¯ÛŒ</option>
      <option value="ÙˆÛŒÚ˜Ù‡">ÙˆÛŒÚ˜Ù‡</option>
      <option value="Ø¯Ø± Ø­Ø§Ù„ Ù‡Ù…Ú©Ø§Ø±ÛŒ">Ø¯Ø± Ø­Ø§Ù„ Ù‡Ù…Ú©Ø§Ø±ÛŒ</option>
    </select>
    <button type="submit" aria-label="Ø°Ø®ÛŒØ±Ù‡ Ù…Ø´ØªØ±ÛŒ">Ø°Ø®ÛŒØ±Ù‡ Ù…Ø´ØªØ±ÛŒ</button>
  </form>
  <ul id="customerList" aria-live="polite" aria-relevant="additions removals"></ul>

  <script>
    // ØµØ¯Ø§Ù‡Ø§
    const soundAdd = new Audio('https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg');
    const soundDelete = new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg');
    const soundEdit = new Audio('https://actions.google.com/sounds/v1/cartoon/pop.ogg');

    let soundEnabled = true;
    const soundToggle = document.getElementById('soundToggle');
    soundToggle.onclick = () => {
      soundEnabled = !soundEnabled;
      soundToggle.textContent = soundEnabled ? 'ğŸ”Š ØµØ¯Ø§ Ø±ÙˆØ´Ù†' : 'ğŸ”‡ ØµØ¯Ø§ Ø®Ø§Ù…ÙˆØ´';
      soundToggle.setAttribute('aria-pressed', soundEnabled);
    };

    let customers = JSON.parse(localStorage.getItem('customers')) || [];
    let editingIndex = -1;

    function saveCustomers() {
      localStorage.setItem('customers', JSON.stringify(customers));
    }

    function playSound(sound) {
      if (!soundEnabled) return;
      sound.currentTime = 0;
      sound.play();
    }

    function renderCustomers() {
      const list = document.getElementById('customerList');
      const search = document.getElementById('searchInput').value.toLowerCase();
      const sort = document.getElementById('sortSelect').value;

      let filtered = [...customers];
      if (search) {
        filtered = filtered.filter(c =>
          c.name.toLowerCase().includes(search) ||
          c.insta.toLowerCase().includes(search) ||
          c.telegram.toLowerCase().includes(search) ||
          c.note.toLowerCase().includes(search) ||
          c.tag.toLowerCase().includes(search)
        );
      }
      if (sort === 'name') {
        filtered.sort((a, b) => a.name.localeCompare(b.name));
      } else if (sort === 'tag') {
        filtered.sort((a, b) => a.tag.localeCompare(b.tag));
      } else {
        filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
      }

      list.innerHTML = '';
      filtered.forEach((c, i) => {
        const li = document.createElement('li');
        li.className = 'card';
        li.setAttribute('tabindex', '0');
        li.innerHTML = `
          <div class="info">
            <strong>${escapeHTML(c.name)}</strong>
            <span>ğŸ“¸ Ø§ÛŒÙ†Ø³ØªØ§: ${escapeHTML(c.insta)}</span>
            <span>ğŸ’¬ ØªÙ„Ú¯Ø±Ø§Ù…: ${escapeHTML(c.telegram)}</span>
            <span class="tags">ğŸ· ${escapeHTML(c.tag)} | ğŸ—“ ${escapeHTML(c.date)}</span>
            <span>${c.note ? 'ğŸ“ ' + escapeHTML(c.note) : ''}</span>
          </div>
          <div class="actions">
            <button class="edit" aria-label="ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø´ØªØ±ÛŒ ${escapeHTML(c.name)}">âœï¸</button>
            <button class="delete" aria-label="Ø­Ø°Ù Ù…Ø´ØªØ±ÛŒ ${escapeHTML(c.name)}">âŒ</button>
          </div>
        `;
        // Ø­Ø°Ù Ø¨Ø§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ùˆ ØµØ¯Ø§
        li.querySelector('.delete').onclick = () => {
          if (confirm(`Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ù…Ø´ØªØ±ÛŒ "${c.name}" Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ`)) {
            li.style.animation = 'slideOutLeft 0.5s forwards';
            playSound(soundDelete);
            setTimeout(() => {
              customers.splice(i, 1);
              saveCustomers();
              renderCustomers();
            }, 500);
          }
        };
        // ÙˆÛŒØ±Ø§ÛŒØ´ Ùˆ ØµØ¯Ø§
        li.querySelector('.edit').onclick = () => {
          document.getElementById('name').value = c.name;
          document.getElementById('insta').value = c.insta;
          document.getElementById('telegram').value = c.telegram;
          document.getElementById('note').value = c.note;
          document.getElementById('tag').value = c.tag;
          editingIndex = i;
          playSound(soundEdit);
          document.getElementById('name').focus();
        };
        list.appendChild(li);
      });
    }

    // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ØªØ²Ø±ÛŒÙ‚ Ú©Ø¯ Ù…Ø®Ø±Ø¨ Ø¯Ø± Ù…ØªÙ†â€ŒÙ‡Ø§
    function escapeHTML(text) {
      if (!text) return '';
      return text.replace(/[&<>"']/g, function (m) {
        return ({
          '&': '&amp;',
          '<': '&lt;',
          '>': '&gt;',
          '"': '&quot;',
          "'": '&#39;'
        })[m];
      });
    }

    document.getElementById('customerForm').onsubmit = e => {
      e.preventDefault();
      const nameVal = document.getElementById('name').value.trim();
      const instaVal = document.getElementById('insta').value.trim();
      const telegramVal = document.getElementById('telegram').value.trim();
      const noteVal = document.getElementById('note').value.trim();
      const tagVal = document.getElementById('tag').value;
      const dateVal = new Date().toLocaleDateString('fa-IR');

      if (!nameVal) {
        alert('Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
        return;
      }

      if (editingIndex > -1) {
        customers[editingIndex] = {
          name: nameVal,
          insta: instaVal,
          telegram: telegramVal,
          note: noteVal,
          tag: tagVal,
          date: customers[editingIndex].date
        };
        editingIndex = -1;
      } else {
        customers.push({
          name: nameVal,
          insta: instaVal,
          telegram: telegramVal,
          note: noteVal,
          tag: tagVal,
          date: dateVal
        });
      }
      saveCustomers();
      renderCustomers();
      e.target.reset();
      playSound(soundAdd);
    };

    document.getElementById('searchInput').addEventListener('input', renderCustomers);
    document.getElementById('sortSelect').addEventListener('change', renderCustomers);

    // Ù†Ù…Ø§ÛŒØ´ Ø§ÙˆÙ„ÛŒÙ‡
    renderCustomers();
  </script>
<h2 style="margin-top:40px; text-align:center;">Ù…Ø¯ÛŒØ±ÛŒØª ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</h2>

<form id="transactionForm" style="max-width:800px; margin: 10px auto 30px auto; background: linear-gradient(145deg, #1a1a1a, #1c1c1c); padding: 20px; border-radius: 16px; box-shadow: 0 8px 16px rgba(0,0,0,0.4); color: #eee; font-family: 'Vazir', sans-serif;">
  <div style="display:flex; gap:12px; flex-wrap: wrap; align-items: center;">
    <input type="text" id="transactionCustomer" placeholder="Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ (Ø¯Ù‚ÛŒÙ‚ Ø¨Ù†ÙˆÛŒØ³)" required
      style="flex:1; padding:10px; border-radius: 10px; border:none; background:#1e1e1e; color:#eee; font-size:14px;">
    <select id="transactionType" required
      style="padding:10px; border-radius:10px; border:none; background:#1e1e1e; color:#eee; font-size:14px; width:140px;">
      <option value="">Ù†ÙˆØ¹ ØªØ±Ø§Ú©Ù†Ø´</option>
      <option value="Ù¾Ø±Ø¯Ø§Ø®Øª">Ù¾Ø±Ø¯Ø§Ø®Øª</option>
      <option value="Ø¨Ø¯Ù‡ÛŒ">Ø¨Ø¯Ù‡ÛŒ</option>
    </select>
    <input type="number" id="transactionAmount" placeholder="Ù…Ø¨Ù„Øº (ØªÙˆÙ…Ø§Ù†)" min="1" required
      style="width:130px; padding:10px; border-radius: 10px; border:none; background:#1e1e1e; color:#eee; font-size:14px;">
    <input type="date" id="transactionDate" required
      style="padding:10px; border-radius: 10px; border:none; background:#1e1e1e; color:#eee; font-size:14px; width:160px;">
    <button type="submit"
      style="background:#5a5af3; color:#fff; border:none; padding: 12px 20px; border-radius: 10px; cursor:pointer; font-weight:bold; font-size:14px; transition: background 0.3s ease;">
      Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´
    </button>
  </div>
</form>

<ul id="transactionList" style="max-width:800px; margin:auto; list-style:none; padding:0; font-family: 'Vazir', sans-serif;">
  <!-- ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø±Ù†Ø¯Ø± Ù…ÛŒØ´Ù† -->
</ul>

<script>
  // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ùˆ Ø°Ø®ÛŒØ±Ù‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§
  let transactions = JSON.parse(localStorage.getItem('transactions')) || [];

  // ØµØ¯Ø§ÛŒ Ú©Ù„ÛŒÚ© Ø¯Ú©Ù…Ù‡ Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´
  const clickSound = new Audio('https://actions.google.com/sounds/v1/ui/click.ogg');

  function saveTransactions() {
    localStorage.setItem('transactions', JSON.stringify(transactions));
  }

  function renderTransactions() {
    const list = document.getElementById('transactionList');
    list.innerHTML = '';
    if (transactions.length === 0) {
      list.innerHTML = '<li style="text-align:center; color:#777; padding: 20px;">Ù‡ÛŒÚ† ØªØ±Ø§Ú©Ù†Ø´ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡</li>';
      return;
    }

    transactions.forEach((t, i) => {
      const li = document.createElement('li');
      li.style.cssText = `
        background: linear-gradient(145deg, #222, #1c1c1c);
        margin-bottom: 12px;
        padding: 14px 20px;
        border-radius: 16px;
        box-shadow: 0 6px 12px rgba(0,0,0,0.4);
        color: #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        animation: fadeIn 0.3s ease forwards;
        cursor: default;
      `;

      // Ø±Ù†Ú¯ Ù†ÙˆØ¹ ØªØ±Ø§Ú©Ù†Ø´
      let typeColor = t.type === 'Ù¾Ø±Ø¯Ø§Ø®Øª' ? '#4CAF50' : '#E74C3C';

      li.innerHTML = `
        <div>
          <strong style="font-size:16px;">${t.customer}</strong> 
          <span style="color:${typeColor}; font-weight:bold; margin-right:10px;">[${t.type}]</span>
          <span>${t.amount.toLocaleString('fa-IR')} ØªÙˆÙ…Ø§Ù†</span>
          <div style="color:#bbb; font-size:13px; margin-top:4px;">${new Date(t.date).toLocaleDateString('fa-IR')}</div>
        </div>
        <button data-index="${i}" title="Ø­Ø°Ù ØªØ±Ø§Ú©Ù†Ø´" style="
          background:#e74c3c; border:none; border-radius:12px; color:#fff; font-weight:bold; 
          padding:6px 10px; cursor:pointer; font-size:13px; transition: background 0.3s ease;">Ø­Ø°Ù</button>
      `;

      li.querySelector('button').onclick = e => {
        const index = +e.target.getAttribute('data-index');
        if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù†ÛŒØ¯ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† ØªØ±Ø§Ú©Ù†Ø´ Ø­Ø°Ù Ø´ÙˆØ¯ØŸ')) {
          transactions.splice(index, 1);
          saveTransactions();
          renderTransactions();
        }
      };

      list.appendChild(li);
    });
  }

  document.getElementById('transactionForm').onsubmit = e => {
    e.preventDefault();
    const customer = document.getElementById('transactionCustomer').value.trim();
    const type = document.getElementById('transactionType').value;
    const amount = parseInt(document.getElementById('transactionAmount').value);
    const date = document.getElementById('transactionDate').value;

    // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ Ø¯Ø± Ù„ÛŒØ³Øª Ù…Ø´ØªØ±ÛŒâ€ŒÙ‡Ø§ (localStorage ÛŒØ§ Ø¢Ø±Ø§ÛŒÙ‡ Ù…Ø´ØªØ±ÛŒâ€ŒÙ‡Ø§)
    const customers = JSON.parse(localStorage.getItem('customers')) || [];
    if (!customers.some(c => c.name === customer)) {
      alert('Ù…Ø´ØªØ±ÛŒ ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ø¯Ø± Ù„ÛŒØ³Øª Ù…Ø´ØªØ±ÛŒâ€ŒÙ‡Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª. Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ø¯Ù‚ÛŒÙ‚ Ù…Ø´ØªØ±ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
      return;
    }

    if (!type || !amount || !date) {
      alert('Ù„Ø·ÙØ§ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ú©Ø§Ù…Ù„ Ú©Ù†ÛŒØ¯.');
      return;
    }

    // ØµØ¯Ø§ÛŒ Ú©Ù„ÛŒÚ© Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´
    clickSound.play();

    transactions.push({ customer, type, amount, date });
    saveTransactions();
    renderTransactions();

    e.target.reset();
  };

  // Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒØ´ ÙØ±Ø¶ ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ²
  document.getElementById('transactionDate').valueAsDate = new Date();

  renderTransactions();

  // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ú©Ù„ÛŒØ¯
  const style = document.createElement('style');
  style.innerHTML = `
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(10px);}
      to {opacity: 1; transform: translateY(0);}
    }
    button:hover {
      filter: brightness(1.15);
      transform: scale(1.05);
      transition: all 0.2s ease;
    }
  `;
  document.head.appendChild(style);
</script>

</body>
</html>













